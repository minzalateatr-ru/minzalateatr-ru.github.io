/* ===========================================================
 * jquery-interactive_bg.js v1.0
 * ===========================================================
 * Copyright 2014 Pete Rojwongsuriya.
 * http://www.thepetedesign.com
 *
 * Create an interactive moving background
 * that reacts to viewer's cursor
 *
 * https://github.com/peachananr/interactive_bg
 * 
 * License: GPL v3
 *
 * ========================================================== */
'use strict';
!function(n){var i={strength:25,scale:1.05,animationSpeed:"100ms",contain:!0,wrapContent:!1};n.fn.interactive_bg=function(t){return this.each(function(){function a(n){var i=Math.round(10*event.accelerationIncludingGravity.x)/10,t=Math.round(10*event.accelerationIncludingGravity.y)/10,a=-(i/10)*e.strength,o=-(t/10)*e.strength,s=-(2*a),m=-(2*o);r.find("> .ibg-bg").css({"-webkit-transform":"matrix("+e.scale+",0,0,"+e.scale+","+s+","+m+")","-moz-transform":"matrix("+e.scale+",0,0,"+e.scale+","+s+","+m+")","-o-transform":"matrix("+e.scale+",0,0,"+e.scale+","+s+","+m+")",transform:"matrix("+e.scale+",0,0,"+e.scale+","+s+","+m+")"})}var e=n.extend({},i,t),r=n(this),o=r.outerHeight(),s=r.outerWidth(),m=e.strength/o,c=e.strength/s,d="ontouchstart"in document.documentElement;1==e.contain&&r.css({overflow:"hidden"}),0==e.wrapContent?r.prepend("<div class='ibg-bg'></div>"):r.wrapInner("<div class='ibg-bg'></div>"),void 0!==r.data("ibg-bg")&&r.find("> .ibg-bg").css({background:"url('"+r.data("ibg-bg")+"') no-repeat center center","background-size":"cover"}),r.find("> .ibg-bg").css({width:s,height:o}),d||screen.width<=699?window.addEventListener("devicemotion",a,!1):r.mouseenter(function(n){1!=e.scale&&r.addClass("ibg-entering"),r.find("> .ibg-bg").css({"-webkit-transform":"matrix("+e.scale+",0,0,"+e.scale+",0,0)","-moz-transform":"matrix("+e.scale+",0,0,"+e.scale+",0,0)","-o-transform":"matrix("+e.scale+",0,0,"+e.scale+",0,0)",transform:"matrix("+e.scale+",0,0,"+e.scale+",0,0)","-webkit-transition":"-webkit-transform "+e.animationSpeed+" linear","-moz-transition":"-moz-transform "+e.animationSpeed+" linear","-o-transition":"-o-transform "+e.animationSpeed+" linear",transition:"transform "+e.animationSpeed+" linear"}).on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.removeClass("ibg-entering")})}).mousemove(function(n){if(!r.hasClass("ibg-entering")&&!r.hasClass("exiting")){var i=n.pageX||n.clientX,t=n.pageY||n.clientY,i=i-r.offset().left-s/2,t=t-r.offset().top-o/2,a=c*i*-1,d=m*t*-1;r.find("> .ibg-bg").css({"-webkit-transform":"matrix("+e.scale+",0,0,"+e.scale+","+a+","+d+")","-moz-transform":"matrix("+e.scale+",0,0,"+e.scale+","+a+","+d+")","-o-transform":"matrix("+e.scale+",0,0,"+e.scale+","+a+","+d+")",transform:"matrix("+e.scale+",0,0,"+e.scale+","+a+","+d+")","-webkit-transition":"none","-moz-transition":"none","-o-transition":"none",transition:"none"})}}).mouseleave(function(n){1!=e.scale&&r.addClass("ibg-exiting"),r.addClass("ibg-exiting").find("> .ibg-bg").css({"-webkit-transform":"matrix(1,0,0,1,0,0)","-moz-transform":"matrix(1,0,0,1,0,0)","-o-transform":"matrix(1,0,0,1,0,0)",transform:"matrix(1,0,0,1,0,0)","-webkit-transition":"-webkit-transform "+e.animationSpeed+" linear","-moz-transition":"-moz-transform "+e.animationSpeed+" linear","-o-transition":"-o-transform "+e.animationSpeed+" linear",transition:"transform "+e.animationSpeed+" linear"}).on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.removeClass("ibg-exiting")})})})}}(window.jQuery);